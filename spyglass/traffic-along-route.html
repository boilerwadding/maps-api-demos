<!DOCTYPE html>
<html>
  <head>
<!-- Based on Josh Livni's demo of drawing labels on top of a Fusion Tables layer,
http://jlivni.github.io/bearded-demos/label_fade_hack.html-->
  <title>Magnifier map inset demo</title>
  <meta name="viewport"
      content="width=device-width, initial-scale=1.0, user-scalable=no">
  <meta charset="UTF-8">
  <style type="text/css">
    html, body{
      margin: 0;
      padding: 0;
      height: 100%;
    }
    #map_canvas1, #map_canvas2{
      height:100%;
      width:100%;
      position:absolute;
      top:0px;
      left:0px;
    }
    #map_canvas2{
      clip-path: "url(#svgPath)"; //firefox, safari, opera
      -webkit-clip-path: "url(#svgPath)"; //chrome
    }
    #controls{
      position:absolute;
      top:10px;
      left:100px;
    }

  </style>
  <!-- clip region for Firefox -->
  <svg height="0" width="0">
    <defs>
      <clipPath id="svgPath" clipPathUnits="objectBoundingBox">
        <polygon points=".5 0, 1 .5, .5 1, 0 .5" />
      </clipPath>
    </defs>
  </svg>

  <script type="text/javascript"
      src="https://maps.googleapis.com/maps/api/js?&sensor=false"></script>
  <script type="text/javascript">
  var map1;
  var map2;
  var London = new google.maps.LatLng(51.5, -0.1);
  var traffic;
  var radius = 200;
  var baseStyles = [
    {
      elementType: "labels",
      stylers: [
        { visibility: "off" }
        ]
    }
  ]
  var overlayStyles = [
      {
        elementType: "geometry",
        stylers: [
          { visibility: "off" },
          { saturation: -100 }
          ]
      },{
        featureType: "road",
        stylers: [
          { visibility: "simplified" }
          ]
      },{
        featureType: "administrative",
        elementType: "labels",
        stylers: [
          { visibility: "on" }
          ]
      }
    ]

function initialize() {
  var myOptions = {
    zoom: 12,
    center: London,
    mapTypeId: google.maps.MapTypeId.ROADMAP
  };
  map1 = new google.maps.Map(document.getElementById('map_canvas1'), myOptions);
  map2 = new google.maps.Map(document.getElementById('map_canvas2'), myOptions);

  map1.set('styles', baseStyles);
  map2.set('styles', overlayStyles);

  //instantiating the map seems to override transparent css
  document.getElementById('map_canvas2').style.background ='transparent';
  document.getElementById("map_canvas2").style.WebkitClipPath = 'url(#svgPath)';

  traffic = new google.maps.TrafficLayer();
  traffic.setMap(map2);

  map1.bindTo('zoom',map2)
  map1.bindTo('center',map2)

}

function setOverlay(id){
  var sel = document.getElementById(id);
  var val = sel.options[sel.selectedIndex].value;

  if(val.indexOf("google.maps.MapTypeId")==0){
    map2.setMapTypeId(eval(val));
    traffic.setMap(null);
  } else {
    map2.setMapTypeId(google.maps.MapTypeId.ROADMAP);
    traffic.setMap(map2);
  }
}

google.maps.event.addDomListener(window, 'load', initialize);

</script>
  </head>
  <body>

    <div id="map_canvas1"></div>
    <div id="map_canvas2"></div>
  </body>
</html>
